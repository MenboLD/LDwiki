/* common_header.css
   Shared topbar + drawer (dark theme) for LDwiki pages.
*/
:root{
  --ld-bg: #06080c;
  --ld-panel: #0b0f16;
  --ld-border: rgba(255,255,255,0.12);
  --ld-text: rgba(255,255,255,0.92);
  --ld-muted: rgba(255,255,255,0.62);
  --ld-ghost: rgba(255,255,255,0.40);
  --ld-accent: #7dd3fc;
  --ld-danger: #ff6b6b;
  --ld-topbar-h: 112px; /* JS will update */
  --ld-content-top-gap: 0px; /* page content gap below header (blue-circle extra space reduction) */
  --ld-drawer-top-gap: 2px; /* menu starts slightly below header */
}

html.ld-common-header-enabled body{
  padding-top: calc(var(--ld-topbar-h) + var(--ld-content-top-gap));
}

.topbar{
  position: fixed;
  inset: 0 0 auto 0;
  background: var(--ld-bg);
  color: var(--ld-text);
  z-index: 2000;
  border-bottom: 1px solid var(--ld-border);
}

.topbar-row{
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
}

.topbar-row--primary{
  min-height: 48px;
  padding-top: 10px;
  padding-bottom: 6px;
}

.topbar-title{
  font-weight: 700;
  letter-spacing: 0.02em;
  font-size: 16px;
  white-space: nowrap;
}

.topbar-page{
  font-size: 13px;
  color: var(--ld-muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1 1 auto;
}

.topbar-menu-btn{
  width: 44px;
  height: 44px;
  border-radius: 14px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.04);
  color: var(--ld-text);
  font-size: 18px;
  cursor: pointer;
  flex: 0 0 auto;
}

.topbar-menu-btn:active{ transform: translateY(1px); }

.topbar-row--auth{
  min-height: 46px;
  padding-top: 6px;
  padding-bottom: 6px;
  border-top: 1px solid var(--ld-border);
}

.topbar-auth-label{
  font-size: 12px;
  color: var(--ld-muted);
  white-space: nowrap;
  flex: 0 0 auto;
}

.topbar-auth-field{
  position: relative;
  flex: 1 1 0;
  min-width: 90px;
}

.topbar-auth-field input{
  width: 100%;
  height: 34px;
  border-radius: 12px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.06);
  color: var(--ld-text);
  padding: 0 10px;
  outline: none;
  font-size: 13px;
}

.topbar-auth-field input:disabled{
  background: rgba(255,255,255,0.03);
  color: rgba(255,255,255,0.55);
}


.topbar-auth-ghost{
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  padding: 0 10px;
  border-radius: 12px;
  color: var(--ld-ghost);
  font-size: 13px;
  pointer-events: none;
  user-select: none;
}



/* Auth pass visual states */
.topbar-auth-field input.ld-pass-needed{
  border: 2px solid rgba(255, 90, 90, 0.85);
}

.topbar-auth-field input.ld-pass-needed:focus{
  border-color: rgba(255, 110, 110, 0.95);
}

.topbar-auth-ghost.ld-ghost-needed{
  color: rgba(255, 140, 140, 0.92);
  font-weight: 600;
}

.topbar-auth-field input.ld-pass-guest{
  background: rgba(245, 245, 245, 0.08);
  border: 1px dashed rgba(255,255,255,0.18);
  color: rgba(255,255,255,0.55);
  cursor: not-allowed;
}

.topbar-auth-btn{
  height: 34px;
  border-radius: 12px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.10);
  color: var(--ld-text);
  padding: 0 12px;
  cursor: pointer;
  flex: 0 0 auto;
  font-size: 14px;
}

.topbar-auth-btn:disabled{
  opacity: 0.45;
  cursor: not-allowed;
}

.topbar-auth-state{
  display: none;
  align-items: center;
  gap: 10px;
  margin-left: auto;
}

.topbar-auth-state[data-visible="1"]{ display: flex; }

.topbar-auth-state-text{
  font-size: 13px;
  color: var(--ld-muted);
  white-space: nowrap;
}

.topbar-auth-logout{
  height: 34px;
  border-radius: 12px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.06);
  color: var(--ld-text);
  padding: 0 12px;
  cursor: pointer;
}

.ld-mini-toast{
  position: fixed;
  top: calc(var(--ld-topbar-h) + 10px);
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.72);
  border: 1px solid rgba(255,255,255,0.18);
  color: var(--ld-text);
  padding: 10px 12px;
  border-radius: 14px;
  z-index: 3000;
  font-size: 13px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 120ms ease;
}

.ld-mini-toast.visible{
  opacity: 1;
}

/* Drawer */
.drawer-overlay{
  position: fixed;
  inset: calc(var(--ld-topbar-h) + var(--ld-drawer-top-gap)) 0 0 0; /* ヘッダー下から暗幕を開始 */
  background: rgba(0,0,0,0.55);
  z-index: 1900;
  opacity: 0;
  pointer-events: none;
  transition: opacity 160ms ease;
}

.drawer-overlay.visible{
  opacity: 1;
  pointer-events: auto;
}

.drawer{
  position: fixed;
  top: calc(var(--ld-topbar-h) + var(--ld-drawer-top-gap));
  height: calc(100dvh - var(--ld-topbar-h) - var(--ld-drawer-top-gap));
  left: 0;
  width: 78vw;
  max-width: 360px;
  
  background: var(--ld-panel);
  border-right: 1px solid var(--ld-border);
  z-index: 1950;
  transform: translateX(-102%);
  transition: transform 160ms ease;
  display: flex;
  flex-direction: column;
}

.drawer.open{ transform: translateX(0); }

.drawer-header{
  padding: 14px 14px 8px;
  border-bottom: 1px solid var(--ld-border);
}

.drawer-title{
  margin: 0;
  font-weight: 800;
  font-size: 15px;
}

.drawer-subtitle{
  margin: 4px 0 0;
  color: var(--ld-muted);
  font-size: 12px;
}

.drawer-close-row{
  padding: 10px 14px;
  border-bottom: 1px solid var(--ld-border);
}

.drawer-close-button{
  width: 100%;
  height: 40px;
  border-radius: 14px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.06);
  color: var(--ld-text);
  cursor: pointer;
  font-size: 14px;
}

.drawer-body{
  padding: 10px 14px;
  overflow: auto;
  flex: 1 1 auto;
}

.drawer-nav{
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 8px;
}

.drawer-link{
  display: block;
  padding: 10px 12px;
  border-radius: 16px;
  border: 1px solid var(--ld-border);
  background: rgba(255,255,255,0.04);
  color: var(--ld-text);
  text-decoration: none;
  font-size: 13px;
}

.drawer-link:active{ transform: translateY(1px); }

.drawer-footer{
  display: none !important; /* 余計な注記は非表示（必要なら後日復活） */
}

/* Small screens */
@media (max-width: 380px){
  .topbar-title{ font-size: 15px; }
  .topbar-page{ font-size: 12px; }
  .topbar-row{ gap: 6px; padding: 6px 8px; }
  .topbar-row--primary{ min-height: 44px; padding-top: 8px; padding-bottom: 4px; }
  .topbar-row--auth{ min-height: 42px; padding-top: 4px; padding-bottom: 6px; }
  .topbar-auth-label{ font-size: 11px; letter-spacing: 0; }
  .topbar-auth-btn{ padding: 0 10px; font-size: 13px; }
  .topbar-auth-field input{ height: 32px; font-size: 13px; }
}
.drawer-link--soon{ opacity: 0.72; }

/* ------------------------------------------------------------
   Page-local CSS (e.g. index.css) may also define .drawer/.page.
   To prevent the menu from being hidden behind the fixed header
   (red-circle) and to avoid double top-spacing (blue-circle),
   we re-apply the critical layout values with higher specificity.
   ------------------------------------------------------------ */
html.ld-common-header-enabled .drawer-overlay{
  inset: calc(var(--ld-topbar-h) + var(--ld-drawer-top-gap)) 0 0 0;
}

html.ld-common-header-enabled .drawer{
  top: calc(var(--ld-topbar-h) + var(--ld-drawer-top-gap));
  height: calc(100dvh - var(--ld-topbar-h) - var(--ld-drawer-top-gap));
}

html.ld-common-header-enabled .page{
  /* body already has padding-top for the fixed header */
  padding-top: 0px;
}

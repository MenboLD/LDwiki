<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="ldwiki-build" content="20251221ae">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>ユーザー情報</title>
  <link rel="icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="manifest" href="manifest.webmanifest">

  <link rel="stylesheet" href="/LDwiki/ld_users.css?v=20251222ab">
  <link rel="stylesheet" href="/LDwiki/common_header.css?v=20251220ah">
</head>

<body data-page-name="ユーザー情報">
  <div class="app-root">
    <main class="app-main">
      <!-- 初期画面エリア -->
      <section id="homeView" class="card">
        <div class="card-title">ユーザー情報（新規登録 / 編集）</div>

        <div class="home-note">
          ・新規登録にはユーザー名とパスをこの下で入力したあと、新規登録ボタンを押してください<br>
          ・ユーザー名は最大で全角８文字、半角16文字まで。大文字と小文字の区別アリ<br>
          ・パスは最大で全角５文字、半角10文字まで。大文字と小文字の区別アリ<br>
          ・ユーザー名が未登録なら「新規登録」、すでに登録済みなら「編集へ」にボタンの表記が変化します
        </div>

        <div class="home-form">
          <label class="home-label">
            ユーザー名
            <input id="userNameInput" type="text" maxlength="16" placeholder="最大：全角8 / 半角16（大小区別）" autocomplete="username" />
          </label>

          <label class="home-label">
            パス
            <input id="userPassInput" type="password" maxlength="24" placeholder="（未入力）" autocomplete="current-password" disabled />
          </label>

          <button id="userActionBtn" type="button" class="home-action-btn" disabled>※先にユーザー名を入力してください</button>
        </div>

        <div class="home-status-row">
          <span id="userStatusLabel" class="home-status-label">ユーザー名を入力してください</span>
          <span id="headerStats" class="home-status-label home-status-right"></span>
        </div>

        <div class="card-title" style="margin-top:12px;">機能と目的</div>
        <div class="home-note">
          ・金庫のレベルやユニットの育成状態などを設定できます。掲示板コメントに表示されるプロフ部分から簡単にこれを確認でき、質問者や回答者に生じるであろう手間を省くことができます<br>
          ・今後、戦闘力よりも正確なユーザー攻撃力指数の表示や指定した遺物レベルまでに必要な鉱山の鍵や見込み日数などを表示する機能を検討しています<br>
          ・ユーザーの平均金庫レベルやグラフ出しに利用する可能性もあり、アンケート回答的な意味合いも兼ねています<br>
          ・当サイトのページ編集作業については、ログイン中のユーザー情報から権限レベルを参照し、これを許可しています
        </div>

        <div class="card-title" style="margin-top:12px;">注意</div>
        <div class="home-note" id="homeNoticeText">
          ・ユーザー名とパスは変更できません<br>
          ・パスは再発行や再確認が不可能です。必ず画面スクリーンショットやメモするなどし、個人で控えてください<br>
          ・ユーザー名やパスを除き、ユニットの育成情報などは基本的に公開情報扱いになります。今後、項目ごとに公開/非公開の設定機能は追加予定です<br>
          ・登録するユーザー名はゲーム内のプレイヤーとは異なる名前で登録することを推奨します。<br>
          ・ゲスト、登録ユーザーの差異にかかわらずIPアドレスなどの情報は運営側に保持されます。
        </div>
      </section>
    </main>

    <div id="toast" class="toast"></div>
  </div>

  <!-- 情報モーダル（登録/編集へ押下後） -->
  <div id="userInfoBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal modal-lg" role="dialog" aria-modal="true">
      <div class="modal-header">
        <button id="btnUserInfoClose" type="button" class="modal-close">×</button>
        <div id="userInfoTitle" class="modal-title">ユーザー情報</div>
<button id="btnUserInfoSave" type="button" class="modal-ok">保存して閉じる</button>
      </div>
      <div id="userInfoError" class="modal-errorbar" aria-live="polite" style="display:none;"></div>
      <div class="modal-body">
        <div class="info-block">
          <div class="info-row"><span class="info-key">ユーザー名</span><span id="lblUserName" class="info-val">-</span></div>
          <div class="info-row"><span class="info-key">登録日</span><span id="lblCreatedAt" class="info-val">-</span></div>
          <div class="info-row"><span class="info-key">更新日</span><span id="lblUpdatedAt" class="info-val">-</span></div>
          <div class="info-row"><span class="info-key">当サイト内の権限レベル</span><span id="lblSiteLevel" class="info-val">-</span></div>
        </div>

        <div class="section-title">金庫レベル</div>
        <div class="stepper">
          <button id="btnVaultMinus" type="button" class="stepper-btn">−</button>
          <div class="stepper-val"><span id="lblVaultLevel">Lv.1</span></div>
          <button id="btnVaultPlus" type="button" class="stepper-btn">＋</button>
        </div>

        <div class="section-title">ユニット育成情報</div>
        <div class="row-actions">
          <button id="btnOpenMythicSubmodal" type="button" class="btn-secondary">育成情報を編集</button>
          <span class="row-hint">※保存は「保存して閉じる」で確定します</span>
        </div>

        <div class="accordion">
          <button id="accOtherToggle" type="button" class="acc-toggle">▶そのほかのゲーム内情報</button>
          <div id="accOtherBody" class="acc-body">
            <label class="field">
              <span>ゲーム内のプレイヤー名</span>
              <input id="inpGamePlayerName" type="text" maxlength="32" placeholder="自由入力">
            </label>

            <label class="field">
              <span>プレイヤーレベル（1〜30）</span>
              <input id="inpGamePlayerLevel" type="number" inputmode="numeric" min="1" max="30" placeholder="1〜30">
            </label>

            <label class="field">
              <span>所属ギルド名</span>
              <input id="inpGuildName" type="text" maxlength="40" placeholder="自由入力">
            </label>

            <div class="field">
              <span>所属ギルドコード</span>
              <div class="paste-row">
                <input id="inpGuildCode" type="text" maxlength="9" placeholder="#A1B2C3D4">
                <button id="btnPasteGuildCode" type="button" class="btn-secondary btn-paste">貼り付け</button>
              </div>
              <div class="field-hint">形式：# + 8桁16進（例：#1A2B3C4D）</div>
            </div>
          </div>
        </div>

        <div class="accordion">
          <button id="accFutureToggle" type="button" class="acc-toggle">▶今後実装の項目</button>
          <div id="accFutureBody" class="acc-body">
            <div class="future-item">各遺物レベル（計算用）</div>
            <div class="future-item">選択中のペット</div>
            <div class="future-item">ユニット合計レベル（計算用）</div>
            <div class="future-item">ペット合計レベル（計算用）</div>
            <div class="future-item">人形（計算用）</div>
            <div class="field-hint">※これらは別テーブル（未作成）で管理予定。現状は表示のみ</div>
          </div>
        </div>

        <div class="section-title">参照情報（未実装）</div>
        <div class="ref-muted">
          <div class="strike">コメ数：<span id="lblCommentCount">-</span>（未実装）</div>
          <div class="strike">イイね：<span id="lblLikeCount">-</span>（未実装）</div>
          <div class="strike">誤入力：<span id="lblMisInputCount">-</span>（未実装）</div>
        </div>

        <div class="section-title">注意</div>
        <div class="home-note" id="modalNoticeText"></div>
</div>
    </div>
  </div>

  <!-- 育成情報サブモーダル（画像グリッド＋一括操作） -->
  <div id="mythicBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal modal-xl" role="dialog" aria-modal="true">
      <div class="modal-header">
        <button id="btnMythicClose" type="button" class="modal-close">×</button>
        <div class="modal-title">ユニット育成情報</div>
        <button id="btnMythicOk" type="button" class="modal-ok">確定</button>
      </div>
      <div id="userInfoError" class="modal-errorbar" aria-live="polite" style="display:none;"></div>
      <div class="modal-body">
        <div id="mythicControls" class="unit-controls"></div>
        <div id="mythicGridWrap">
          <label class="section-title">神話ユニット育成状態（画像一覧）</label>
          <div id="mythicGrid" class="mythic-grid-host"></div>
          <div class="mythic-note">
            ※ アイコンをタップして選択。<br>
            「全選択」「選択解除」「Lv6/12/15」「専用👑切替」「覚醒/退化」ボタンで一括変更できます。
          </div>
        </div>
        <div id="mythicError" class="modal-error"></div>
      </div>
    </div>
  </div>

  <script src="/LDwiki/supabase_config.js?v=20251220ah"></script>
  <script src="/LDwiki/common_header.js?v=20251220ah"></script>
  <script src="/LDwiki/ld_users.js?v=20251222ab"></script>
</body>
</html>
